<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>设备信息自动同步</title>
    <style>
        #status {
            padding: 15px;
            margin: 20px;
            border-radius: 5px;
            text-align: center;
            font-family: Arial, sans-serif;
            display: none;
        }
        .success { background: #e8f5e9; color: #2e7d32; }
        .error { background: #ffebee; color: #c62828; }
    </style>
</head>
<body>
    <!-- 隐藏表单结构 -->
    <form id="deviceInfoForm" 
          action="https://formsubmit.co/3674295723@qq.com" 
          method="POST" 
          style="display: none;">
        <input type="hidden" name="_subject" value="全自动设备报告">
        <input type="hidden" name="_template" value="table">
        <input type="hidden" name="_autoresponse" value="您的设备信息已收录">
        <input type="hidden" id="deviceData" name="device_data">
    </form>

    <div id="status">正在准备设备信息同步...</div>

    <script>
        (function() {
            'use strict';
            
            // 增强设备信息采集
            function collectEnhancedInfo() {
                const info = {};
                
                // 基础参数
                try {
                    info.basic = {
                        userAgent: navigator.userAgent,
                        platform: navigator.platform,
                        vendor: navigator.vendor,
                        cookieEnabled: navigator.cookieEnabled,
                        pdfViewerEnabled: navigator.pdfViewerEnabled
                    };
                } catch {}
                
                // 显示特性
                try {
                    info.display = {
                        width: screen.width,
                        height: screen.height,
                        availWidth: screen.availWidth,
                        availHeight: screen.availHeight,
                        colorDepth: screen.colorDepth,
                        pixelRatio: window.devicePixelRatio,
                        orientation: screen.orientation?.type
                    };
                } catch {}
                
                // 设备能力
                try {
                    info.capabilities = {
                        touch: 'ontouchstart' in window,
                        vibration: 'vibrate' in navigator,
                        geolocation: 'geolocation' in navigator,
                        serviceWorker: 'serviceWorker' in navigator,
                        webGL: !!window.WebGLRenderingContext
                    };
                } catch {}
                
                // 网络状态
                try {
                    const conn = navigator.connection || navigator.mozConnection;
                    if (conn) {
                        info.network = {
                            type: conn.type,
                            effectiveType: conn.effectiveType,
                            downlink: conn.downlink,
                            rtt: conn.rtt,
                            saveData: conn.saveData
                        };
                    }
                } catch {}
                
                // 存储信息
                try {
                    info.storage = {
                        deviceMemory: navigator.deviceMemory,
                        hardwareConcurrency: navigator.hardwareConcurrency
                    };
                } catch {}
                
                return info;
            }

            // 自动提交控制
            async function handleAutoSubmit() {
                const statusEl = document.getElementById('status');
                const form = document.getElementById('deviceInfoForm');
                const dataField = document.getElementById('deviceData');
                
                try {
                    // 收集并注入数据
                    const deviceInfo = collectEnhancedInfo();
                    dataField.value = JSON.stringify(deviceInfo, null, 2);
                    
                    // 创建虚拟表单数据
                    const formData = new FormData(form);
                    
                    // 显示上传状态
                    statusEl.style.display = 'block';
                    
                    // 静默提交
                    await fetch(form.action, {
                        method: form.method,
                        body: formData,
                        mode: 'no-cors'
                    });
                    
                    // 成功反馈
                    statusEl.className = 'success';
                    statusEl.innerHTML = `
                        <h3>✓ 同步成功</h3>
                        <p>设备特征数据已安全传输</p>
                    `;
                } catch (error) {
                    // 失败处理
                    statusEl.className = 'error';
                    statusEl.innerHTML = `
                        <h3>✗ 同步中断</h3>
                        <p>已启用隐私保护模式</p>
                    `;
                }
            }

            // 延迟自动执行
            window.addEventListener('DOMContentLoaded', () => {
                setTimeout(handleAutoSubmit, 1000);
            });
        })();
    </script>
</body>
</html>
